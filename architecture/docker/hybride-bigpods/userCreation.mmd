sequenceDiagram
    autonumber
    actor User
    participant WebClient as Web Client :5173
    participant Gateway as Gateway :4000
    participant CoreNginx as Core NGINX :80<br/>(Core Pod)
    participant UserService as User Service :3002<br/>(Core Pod)
    participant DB as PostgreSQL<br/>(Infrastructure)

    Note over User,DB: **Triggered after successful registration**
    
    User->>WebClient: Complete signup form<br/>(firstName, lastName, email)
    
    WebClient->>Gateway: POST /api/v1/users/profile/:userId<br/>{<br/>  firstName: "John",<br/>  lastName: "Doe",<br/>  email: "john@example.com"<br/>}
    
    Note over Gateway: No auth required<br/>(called internally by Auth Service)
    
    Gateway->>CoreNginx: Forward to Core Pod :80
    CoreNginx->>UserService: POST /api/v1/users/profile/:userId
    
    Note over UserService: Validate request data:<br/>✅ userId exists<br/>✅ firstName/lastName format<br/>✅ Email format
    
    UserService->>DB: BEGIN TRANSACTION
    
    UserService->>DB: INSERT INTO profiles<br/>(user_id, first_name, last_name, email, created_at)<br/>VALUES (?, ?, ?, ?, NOW())
    
    DB-->>UserService: Profile created (profileId: 456)
    
    Note over UserService: Create default settings
    
    UserService->>DB: INSERT INTO user_preferences<br/>(user_id, language, currency, timezone)<br/>VALUES (?, 'en', 'USD', 'UTC')
    
    DB-->>UserService: Preferences created
    
    UserService->>DB: INSERT INTO notification_settings<br/>(user_id, deal_alerts, trip_reminders)<br/>VALUES (?, true, true)
    
    DB-->>UserService: Notifications settings created
    
    UserService->>DB: INSERT INTO privacy_settings<br/>(user_id, profile_visibility, data_sharing)<br/>VALUES (?, 'PUBLIC', false)
    
    DB-->>UserService: Privacy settings created
    
    UserService->>DB: COMMIT TRANSACTION
    
    UserService-->>CoreNginx: 201 Created<br/>{<br/>  userId: 123,<br/>  profileId: 456,<br/>  message: "Profile created successfully"<br/>}
    
    CoreNginx-->>Gateway: Forward response
    Gateway-->>WebClient: Profile created confirmation
    
    WebClient-->>User: Show "Profile Created!"<br/>message

    Note over User,DB: **Total Time: ~150-250ms**<br/>(4 DB inserts in transaction) 